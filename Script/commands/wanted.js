const axios = require("axios");
const fs = require("fs");
const Canvas = require("canvas");

module.exports.config = {
  name: "wanted",
  version: "2.0.0",
  hasPermssion: 0,
  credits: "Hridoy Khan + GPT Hellfire",
  description: "Make a funny Wanted poster for tagged or random user ğŸ˜",
  commandCategory: "fun",
  usages: "/wanted [@mention]",
  cooldowns: 5,
};

module.exports.run = async function ({ api, event, Users }) {
  try {
    const { threadID, messageID, mentions, participantIDs } = event;
    const template = "https://i.imgur.com/pbC3EwN.jpeg"; // Wanted poster background

    // Mention à¦¨à¦¾ à¦¦à¦¿à¦²à§‡ random à¦à¦•à¦œà¦¨ à¦¬à¦¾à¦›à¦¾à¦‡ à¦•à¦°à¦¬à§‡
    let targetID;
    if (Object.keys(mentions).length > 0) {
      targetID = Object.keys(mentions)[0];
    } else {
      const randomIndex = Math.floor(Math.random() * participantIDs.length);
      targetID = participantIDs[randomIndex];
    }

    // Profile picture à¦†à¦¨à¦¬à§‡
    const avatarUrl = await Users.getAvatarUrl(targetID);
    const bg = await Canvas.loadImage(template);
    const avatar = await Canvas.loadImage(avatarUrl);

    const canvas = Canvas.createCanvas(bg.width, bg.height);
    const ctx = canvas.getContext("2d");

    // Poster draw
    ctx.drawImage(bg, 0, 0, bg.width, bg.height);

    // Avatar positioning (poster à¦…à¦¨à§à¦¯à¦¾à§Ÿà§€ à¦ à¦¿à¦• à¦•à¦°à¦¾)
    const x = 190;
    const y = 430;
    const w = 460;
    const h = 460;

    ctx.drawImage(avatar, x, y, w, h);

    // Output save
    const path = __dirname + "/wanted.png";
    fs.writeFileSync(path, canvas.toBuffer());

    // Funny reasons
    const reasons = [
      "ğŸ” à¦–à¦¾à¦¬à¦¾à¦° à¦¦à§‡à¦–à¦²à§‡à¦‡ à¦¹à¦¾à¦°à¦¿à¦¯à¦¼à§‡ à¦¯à¦¾à¦¯à¦¼ â€” à¦¬à¦¿à¦¶à§‡à¦· à¦•à¦°à§‡ à¦«à§à¦°à¦¿ à¦–à¦¾à¦¬à¦¾à¦°!",
      "ğŸ˜‚ à¦—à§à¦°à§à¦ªà§‡ à¦¸à¦¬à¦¾à¦‡à¦•à§‡ à¦Ÿà§à¦¯à¦¾à¦— à¦•à¦°à§‡ à¦ªà¦¾à¦²à¦¿à¦¯à¦¼à§‡ à¦¯à¦¾à¦¯à¦¼!",
      "ğŸ’¤ à¦¦à¦¿à¦¨à§‡ à§§à§® à¦˜à¦£à§à¦Ÿà¦¾ à¦˜à§à¦®à¦¾à¦¯à¦¼, à¦¤à¦¾à¦°à¦ªà¦°à¦“ à¦¬à¦²à§‡ â€˜à¦†à¦®à¦¿ à¦•à§à¦²à¦¾à¦¨à§à¦¤â€™à¥¤",
      "ğŸ“± à¦šà¦¾à¦°à§à¦œ à§§% à¦¥à¦¾à¦•à¦²à§‡à¦“ TikTok à¦¦à§‡à¦–à¦¾ à¦¬à¦¨à§à¦§ à¦•à¦°à§‡ à¦¨à¦¾!",
      "ğŸ”¥ à¦®à§‡à§Ÿà§‡à¦¦à§‡à¦° à¦‡à¦¨à¦¬à¦•à§à¦¸à§‡ â€˜Hiâ€™ à¦ªà¦¾à¦ à¦¿à¦¯à¦¼à§‡ à¦—à§à¦°à§‡à¦«à¦¤à¦¾à¦°!",
      "ğŸ à¦¬à¦¨à§à¦§à§à¦° à¦—à¦¾à¦°à§à¦²à¦«à§à¦°à§‡à¦¨à§à¦¡à¦•à§‡ à¦­à¦¾à¦‡ à¦¬à¦²à§‡ DM à¦•à¦°à§‡!",
      "ğŸ¤¡ à¦ªà§à¦°à¦¤à¦¿à¦¦à¦¿à¦¨ à¦¨à¦¤à§à¦¨ crush à¦¬à¦¾à¦¨à¦¾à¦¯à¦¼, à¦ªà§à¦°à¦¨à§‹ à¦­à§à¦²à§‡ à¦¯à¦¾à¦¯à¦¼!",
      "ğŸŸ à¦¦à§‹à¦•à¦¾à¦¨à§‡ à¦—à¦¿à¦¯à¦¼à§‡ à¦¬à¦²à§‡ â€˜à¦¬à¦¾à¦•à¦¿ à¦°à¦¾à¦–à§‡à¦¨ à¦­à¦¾à¦‡, à¦•à¦¾à¦² à¦¦à§‡à¦¬â€™à¥¤",
      "ğŸ˜ˆ à¦¸à¦¬à¦¾à¦‡à¦•à§‡ à¦¬à¦²à§‡ â€˜à¦†à¦®à¦¿ innocentâ€™, à¦•à¦¿à¦¨à§à¦¤à§ evidence à¦†à¦›à§‡!",
      "ğŸ­ à¦®à§à¦–à§‡ à¦¬à¦²à§‡ à¦¶à¦¾à¦¨à§à¦¤ à¦›à§‡à¦²à§‡, à¦•à¦¿à¦¨à§à¦¤à§ keyboard warrior!",
      "ğŸ’€ à¦¨à¦¿à¦œà§‡à¦° meme-à¦ à¦¨à¦¿à¦œà§‡ react à¦¦à§‡à§Ÿ â€” à§©à¦Ÿà¦¾ ğŸ˜† emoji à¦¸à¦¹!",
      "ğŸ’ Mirror-à¦à¦° à¦¸à¦¾à¦®à¦¨à§‡ pose à¦¦à¦¿à¦¤à§‡ à¦—à¦¿à§Ÿà§‡ selfie à¦¤à§‡ à¦­à§Ÿ à¦ªà¦¾à§Ÿ!",
      "ğŸ•µï¸ à¦°à¦¾à¦¤à§‡ à§©à¦Ÿà¦¾à§Ÿ à¦®à§‡à¦¸à§‡à¦œ à¦¦à§‡à§Ÿ: â€˜à¦˜à§à¦®à¦¾à¦“à¦¨à¦¿?â€™ â€“ à¦à¦¬à¦‚ à¦¨à¦¿à¦œà§‡à¦‡ reply à¦¦à§‡à§Ÿ!",
      "ğŸ’¸ à¦¨à¦¿à¦œà§‡à¦° à¦œà¦¨à§à¦®à¦¦à¦¿à¦¨à§‡ à¦¨à¦¿à¦œà§‡à¦° à¦œà¦¨à§à¦¯ wish à¦¦à§‡à§Ÿ!",
      "ğŸ“· à¦¸à§‡à¦²à¦«à¦¿ à¦¤à§à¦²à¦¤à§‡ à¦—à¦¿à§Ÿà§‡ à¦«à§‹à¦¨ à¦«à§‡à¦²à§‡ à¦­à§‡à¦™à§‡ à¦«à§‡à¦²à§‡!",
      "ğŸ§  Brain update à¦ªà¦¾à§Ÿà¦¨à¦¿ à§¨à§¦à§§à§¨ à¦¸à¦¾à¦² à¦¥à§‡à¦•à§‡!",
      "ğŸª à¦¨à¦¿à¦œà§‡à¦° shadow-à¦à¦° à¦¸à¦¾à¦¥à§‡ argue à¦•à¦°à§‡ à¦¹à¦¾à¦°à§‡!",
      "ğŸš¨ Emoji abuse-à¦à¦° à¦…à¦ªà¦°à¦¾à¦§à§‡ Wanted!",
      "ğŸ§ƒ Juice à¦¦à§‹à¦•à¦¾à¦¨à§‡ à¦¬à¦²à§‡ â€“ â€˜à¦­à¦¾à¦‡ à§¨ à¦Ÿà¦¾à¦•à¦¾ à¦•à¦® à¦¦à§‡à¦¨â€™à¥¤",
      "ğŸ” WiFi à¦¨à¦¾ à¦¥à¦¾à¦•à¦²à§‡ à¦¨à¦¿à¦œà§‡à¦‡ router à¦¹à¦¤à§‡ à¦šà¦¾à¦¯à¦¼!",
      "ğŸ¬ Drama create à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦²à§‡ Netflix hire à¦•à¦°à¦¤!",
      "ğŸ à¦¬à¦¨à§à¦§à§à¦° à¦ªà§à¦°à§‡à¦®à§‡ â€˜adviceâ€™ à¦¦à§‡à¦¯à¦¼, à¦¶à§‡à¦·à§‡ à¦¨à¦¿à¦œà§‡à¦° crush à¦¨à§‡à§Ÿ!",
      "ğŸ¦¸ à¦¨à¦¿à¦œà§‡à¦•à§‡ superhero à¦­à¦¾à¦¬à§‡, à¦•à¦¿à¦¨à§à¦¤à§ power à¦¨à¦¾à¦‡!",
      "ğŸ˜‚ à¦—à§à¦°à§à¦ªà§‡ à¦¶à§à¦§à§ â€˜Hmmâ€™ à¦ªà¦¾à¦ à¦¾à¦¯à¦¼, à¦•à¦¿à¦›à§à¦‡ à¦¬à§‹à¦à§‡ à¦¨à¦¾!",
      "ğŸ¥´ à¦¶à§‡à¦· à¦¦à§‡à¦–à¦¾ à¦—à§‡à¦›à§‡ â€“ meme factory-à¦° à¦­à§‡à¦¤à¦°!",
      "ğŸ“ à¦•à¦² à¦§à¦°à¦¾à¦° à¦¸à¦®à¦¯à¦¼ à¦¬à¦²à§‡ â€˜à¦­à¦¾à¦‡, à¦šà¦¾à¦°à§à¦œ à¦¶à§‡à¦·â€™, à¦•à¦¿à¦¨à§à¦¤à§ PUBG à¦šà¦¾à¦²à¦¾à¦¯à¦¼!",
      "ğŸ• Pizza à¦¨à¦¾ à¦ªà§‡à¦²à§‡ à¦•à¦¾à¦à¦¦à§‡, burger à¦ªà§‡à¦²à§‡ à¦—à¦¾à¦¨ à¦—à¦¾à¦¯à¦¼!",
      "ğŸ¦Ÿ à¦®à¦¶à¦¾à¦° à¦•à¦¾à¦®à§œ à¦–à§‡à§Ÿà§‡à¦“ à¦¬à¦²à§‡ â€˜bite me moreâ€™!",
      "ğŸ’» à¦ªà¦¿à¦¸à¦¿ à¦šà¦¾à¦²à§ à¦•à¦°à§‡ à¦ªà§à¦°à¦¥à¦®à§‡ Chrome à¦¨à¦¾, Facebook à¦–à§‹à¦²à§‡!",
      "ğŸ¢ à¦¤à§‹à¦° à¦‡à¦¨à§à¦Ÿà¦¾à¦°à¦¨à§‡à¦Ÿ à¦¸à§à¦ªà¦¿à¦¡ à¦¦à§‡à¦–à§‡ snail à¦¹à§‡à¦¸à§‡ à¦¦à¦¿à¦²!",
      "ğŸš€ à¦ªà¦°à§€à¦•à§à¦·à¦¾à§Ÿ à§¨ à¦¨à¦¾à¦®à§à¦¬à¦¾à¦° à¦•à¦®à§‡ à¦—à¦¿à§Ÿà§‡ à¦¥à¦¾à¦¨à¦¾à§Ÿ report à¦•à¦°à§‡à¦›à§‡!",
      "ğŸ¤ à¦—à¦¾à¦¨à§‡à¦° à¦—à¦²à¦¾ à¦à¦®à¦¨ â€” autotune-à¦“ à¦¬à¦²à§‡à¦›à§‡ â€˜à¦†à¦®à¦¿ à¦ªà¦¾à¦°à¦¬ à¦¨à¦¾ à¦­à¦¾à¦‡â€™!",
      "ğŸ“š à¦¬à¦‡ à¦–à§à¦²à§‡ à¦ªà§à¦°à¦¥à¦®à§‡à¦‡ à¦—à¦¨à§à¦§ à¦¨à§‡à§Ÿ, à¦ªà§œà¦¾ à¦¶à§à¦°à§ à¦¹à§Ÿ à¦¨à¦¾!",
      "ğŸ’” à¦ªà§à¦°à§‡à¦®à§‡ à¦ªà§œà§‡ â€˜status updateâ€™ à¦¦à¦¿à§Ÿà§‡ à¦ªà¦¾à¦²à¦¿à§Ÿà§‡ à¦—à§‡à¦›à§‡!",
      "ğŸ”‹ à¦«à§‹à¦¨à§‡à¦° à¦¬à§à¦¯à¦¾à¦Ÿà¦¾à¦°à¦¿ à§§% â€” à¦•à¦¿à¦¨à§à¦¤à§ attitude à§§à§¦à§¦%",
      "ğŸ¤³ à¦¨à¦¿à¦œà§‡à¦° story à¦¤à§‡ à¦¨à¦¿à¦œà§‡ react à¦¦à§‡à§Ÿ!",
      "ğŸ§¦ à¦¦à§à¦‡à¦Ÿà¦¾ à¦®à§‹à¦œà¦¾ à¦ªà¦°à§‡ à¦¸à§à¦•à§à¦²à§‡ à¦¯à¦¾à§Ÿ, à¦à¦•à¦Ÿà¦¾ mismatched!",
      "ğŸ® à¦—à§‡à¦® à¦¹à¦¾à¦°à¦²à§‡ à¦¬à¦²à§‡ â€˜lag à¦¦à¦¿à¦šà§à¦›à§‡ à¦­à¦¾à¦‡â€™!",
      "ğŸŒ§ï¸ à¦¬à§ƒà¦·à§à¦Ÿà¦¿ à¦¦à§‡à¦–à¦²à§‡à¦‡ caption à¦¦à§‡à§Ÿ: â€˜old memories ğŸ˜­â€™",
      "ğŸš¬ à¦šà¦¾ à¦–à§‡à§Ÿà§‡ smoke effect à¦¦à§‡à§Ÿ mouth à¦¦à¦¿à§Ÿà§‡!",
      "ğŸ• à¦•à§à¦•à§à¦°à¦•à§‡ à¦¦à§‡à¦–à¦²à§‡à¦‡ à¦¬à¦²à§‡ â€“ â€˜à¦“à¦‡ à¦†à¦®à¦¾à¦° à¦¬à¦¨à§à¦§à§à¦° à¦®à¦¤à§‹!â€™",
      "ğŸ’€ à¦¨à¦¿à¦œà§‡à¦° joke-à¦ à¦¨à¦¿à¦œà§‡à¦‡ à¦¹à§‡à¦¸à§‡ à¦ªà§œà§‡ à¦¯à¦¾à§Ÿ!",
      "ğŸ¿ à¦¸à¦¿à¦¨à§‡à¦®à¦¾ à¦¦à§‡à¦–à§‡ crying emoji react à¦¦à§‡à§Ÿ!",
      "ğŸ“± à¦«à§‹à¦¨à§‡ à§©à¦Ÿà¦¾ wallpaper, à¦•à¦¿à¦¨à§à¦¤à§ à¦¸à¦¬ à¦¨à¦¿à¦œà§‡à¦°à¦‡ selfie!",
      "ğŸ¯ à¦•à¦–à¦¨à§‹ target miss à¦¨à¦¾ à¦•à¦°à§‡, à¦•à¦¾à¦°à¦£ target-à¦‡ à¦¨à§‡à§Ÿ à¦¨à¦¾!",
      "ğŸš´ à¦¦à§Œà§œ à¦ªà§à¦°à¦¤à¦¿à¦¯à§‹à¦—à¦¿à¦¤à¦¾à§Ÿ à¦¹à§‡à¦à¦Ÿà§‡ à¦…à¦‚à¦¶ à¦¨à§‡à§Ÿ!",
      "ğŸ¦· à¦¹à¦¾à¦¸à¦²à§‡ WiFi disconnect à¦¹à§Ÿà§‡ à¦¯à¦¾à§Ÿ!",
      "ğŸ’¼ CV-à¦¤à§‡ skill à¦²à¦¿à¦–à§‡à¦›à§‡: â€˜fast typing on Messengerâ€™!",
      "ğŸ“ à¦¸à§à¦•à§à¦²à§‡ à¦ªà§à¦°à§‡à¦œà§‡à¦¨à§à¦Ÿà§‡à¦¶à¦¨ à¦¦à§‡à§Ÿ: â€˜Why I hate Mondaysâ€™",
      "ğŸ¥¶ Ice cream à¦–à§‡à§Ÿà§‡ à¦ à¦¾à¦¨à§à¦¡à¦¾ à¦²à¦¾à¦—à§‡, à¦¤à¦¾à¦°à¦ªà¦° status à¦¦à§‡à§Ÿ: RIP throat!",
      "ğŸ˜œ à¦…à¦¯à¦¥à¦¾ cool à¦¹à¦“à§Ÿà¦¾à¦° à¦šà§‡à¦·à§à¦Ÿà¦¾ à¦•à¦°à¦¤à§‡ à¦—à¦¿à§Ÿà§‡ meme à¦¹à§Ÿà§‡ à¦¯à¦¾à§Ÿ!",
      "ğŸ§ƒ à¦¦à§à¦§à§‡à¦° à¦ªà§à¦¯à¦¾à¦•à§‡à¦Ÿà§‡ à¦²à¦¿à¦–à§‡à¦›à§‡ â€“ *WANTED for drinking directly!*",
    ];

    // Random reason + reward
    const reason = reasons[Math.floor(Math.random() * reasons.length)];
    const reward = Math.floor(Math.random() * 90000) + 10000; // à§§à§¦Kâ€“à§§à§¦à§¦K

    const message = `ğŸ§¾ *WANTED NOTICE*\n\nğŸ’€ Crime: ${reason}\nğŸ’° Reward: ${reward.toLocaleString()} à¦•à§Ÿà§‡à¦¨\n\nğŸš¨ Report immediately if seen!`;

    return api.sendMessage(
      { body: message, attachment: fs.createReadStream(path) },
      threadID,
      () => fs.unlinkSync(path),
      messageID
    );
  } catch (err) {
    console.error(err);
    return api.sendMessage("âŒ à¦•à¦¿à¦›à§ à¦­à§à¦² à¦¹à§Ÿà§‡à¦›à§‡!", event.threadID);
  }
};